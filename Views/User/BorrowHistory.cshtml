@using System.Collections.Generic
@model dynamic

@{
    Layout = "~/Views/Shared/_UserLayout.cshtml";
    ViewData["Title"] = "Borrowing History";
}

<div class="container-fluid py-4">
    <div class="mb-4">
        <h2 class="fw-bold text-dark mb-2">Borrowing History</h2>
        <p class="text-muted">View your past equipment borrowing records</p>
    </div>

    @if (Model != null && Model.Count > 0)
    {
        <div class="card shadow-sm border-0">
            <div class="card-header text-white py-3" style="background: linear-gradient(135deg, #0d6efd 0%, #0a58ca 100%);">
                <h5 class="card-title mb-0 fw-bold">
                    <i class="bi bi-journal-text me-2"></i>Borrowing Records
                </h5>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table mb-0 align-middle">
                        <thead style="background-color: #2c3e50; color: white;">
                            <tr>
                                <th class="py-3 px-3 fw-semibold">EQUIPMENT</th>
                                <th class="py-3 px-3 fw-semibold">LABEL</th>
                                <th class="py-3 px-3 fw-semibold">TYPE</th>
                                <th class="py-3 px-3 text-center fw-semibold">QTY</th>
                                <th class="py-3 px-3 fw-semibold">PURPOSE</th>
                                <th class="py-3 px-3 fw-semibold">BORROW DATE</th>
                                <th class="py-3 px-3 fw-semibold">EXPECTED RETURN</th>
                                <th class="py-3 px-3 fw-semibold">ACTUAL RETURN</th>
                                <th class="py-3 px-3 text-center fw-semibold">STATUS</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var record in Model)
                            {
                                <tr style="border-bottom: 1px solid #e9ecef;">
                                    <td class="py-3 px-3 fw-semibold">@record.Name</td>
                                    <td class="py-3 px-3">@record.Label</td>
                                    <td class="py-3 px-3">@record.Type</td>
                                    <td class="py-3 px-3 text-center">@record.Quantity</td>
                                    <td class="py-3 px-3 text-muted" style="max-width: 250px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="@record.Purpose">@record.Purpose</td>
                                    <td class="py-3 px-3">@record.BorrowDate.ToString("MMM dd, yyyy")</td>
                                    <td class="py-3 px-3">@record.ExpectedReturnDate.ToString("MMM dd, yyyy")</td>
                                    <td class="py-3 px-3">
                                        @if (record.ReturnDate != null)
                                        {
                                            @(((DateTime)record.ReturnDate).ToString("MMM dd, yyyy"))
                                        }
                                        else
                                        {
                                            <span class="text-muted">-</span>
                                        }
                                    </td>
                                    <td class="py-3 px-3 text-center">
                                        @if (record.Status == "Borrowed")
                                        {
                                            <span class="badge bg-warning text-dark px-3 py-2">Borrowed</span>
                                        }
                                        else if (record.Status == "Returned")
                                        {
                                            <span class="badge bg-success px-3 py-2">Returned</span>
                                        }
                                        else if (record.Status == "Overdue")
                                        {
                                            <span class="badge bg-danger px-3 py-2">Overdue</span>
                                        }
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="card shadow-sm border-0">
            <div class="card-body text-center py-5">
                <i class="bi bi-clock-history display-3 text-muted mb-3"></i>
                <h4 class="mt-3 text-muted fw-semibold">No Borrowing History</h4>
                <p class="text-muted mb-4">You haven't borrowed any equipment yet.</p>
                <a href="@Url.Action("BorrowEquipment")" class="btn btn-primary btn-sm">
                    <i class="bi bi-laptop me-2"></i>Borrow Equipment
                </a>
            </div>
        </div>
    }
</div>